
{% extends "base.html" %}
{% block title %}AI Review Analysis - Quantum Platform{% endblock %}

{% block content %}
<div class="bg-gradient-to-br from-slate-50 to-blue-50 -mx-4 -my-8 px-4 py-16 text-gray-900 min-h-screen">
  <div class="max-w-5xl mx-auto space-y-8 fade-in">
    <!-- Header -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-8">
      <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6">
        <div class="flex items-center space-x-6">
          <div class="w-20 h-20 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl flex items-center justify-center shadow-lg">
            <i class="fas fa-chart-line text-white text-3xl"></i>
          </div>
          <div>
            <h1 class="text-4xl font-bold text-gray-900 mb-2">AI Business Intelligence</h1>
            <div class="flex items-center gap-4">
              <p class="text-gray-600 text-lg">{{ summary.review_count }} customer reviews analyzed</p>
              {% if is_historical %}
              <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                <i class="fas fa-history mr-2"></i>Historical Report
              </span>
              {% endif %}
            </div>
            <div class="flex items-center gap-4 mt-2">
              <p class="text-sm text-gray-500">Generated: {{ report_date[:19] | replace('T', ' at ') if is_historical else summary.generated_at[:19] | replace('T', ' at ') }}</p>
              {% if is_cached and not is_historical %}
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                <i class="fas fa-clock mr-1"></i>Cached
              </span>
              {% endif %}
            </div>
          </div>
        </div>

        <div class="flex flex-wrap gap-3">
          {% if not is_historical %}
          <a href="{{ url_for('ai_reports_history') }}" 
             class="px-6 py-3 border border-purple-300 text-purple-700 rounded-xl font-semibold hover:bg-purple-50 transition-all">
            <i class="fas fa-history mr-2"></i>View History
          </a>
          {% endif %}
          <a href="{{ url_for('dashboard') }}" 
             class="px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl font-semibold text-white hover:from-indigo-600 hover:to-purple-600 transition-all">
            <i class="fas fa-arrow-left mr-2"></i>Dashboard
          </a>
        </div>
      </div>
    </div>

    <!-- Overall Sentiment Card -->
    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-8 border border-purple-200">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-2xl font-bold text-gray-900 flex items-center">
          <i class="fas fa-gauge-high text-purple-600 mr-3"></i>Overall Sentiment Analysis
        </h3>
        <span class="inline-flex items-center px-6 py-3 rounded-full text-xl font-bold 
          {% if summary.analysis.overall_sentiment == 'positive' %}bg-emerald-100 text-emerald-800{% elif summary.analysis.overall_sentiment == 'negative' %}bg-red-100 text-red-800{% else %}bg-amber-100 text-amber-800{% endif %}">
          {% if summary.analysis.overall_sentiment == 'positive' %}
          <i class="fas fa-smile mr-2"></i>Positive
          {% elif summary.analysis.overall_sentiment == 'negative' %}
          <i class="fas fa-frown mr-2"></i>Negative
          {% else %}
          <i class="fas fa-meh mr-2"></i>Mixed
          {% endif %}
        </span>
      </div>
    </div>

    <!-- Executive Summary -->
    {% if summary.analysis.executive_summary %}
    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-8 border border-indigo-200">
      <div class="flex items-center mb-6">
        <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center mr-4">
          <i class="fas fa-chart-bar text-white text-2xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Executive Summary</h3>
          <p class="text-gray-600">Strategic business intelligence overview</p>
        </div>
      </div>
      <div class="bg-white rounded-lg p-6 border border-indigo-100">
        <p class="text-gray-800 leading-relaxed text-lg font-medium">{{ summary.analysis.executive_summary }}</p>
      </div>
    </div>
    {% endif %}

    <!-- Detailed Analysis -->
    {% if summary.analysis.detailed_analysis %}
    <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
      <div class="flex items-center mb-6">
        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center mr-4">
          <i class="fas fa-microscope text-white text-2xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Comprehensive Business Analysis</h3>
          <p class="text-gray-600">Detailed insights, issues, and strategic recommendations</p>
        </div>
      </div>
      <div class="bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg p-8 border border-gray-200">
        <p class="text-gray-800 leading-relaxed text-lg whitespace-pre-line">{{ summary.analysis.detailed_analysis }}</p>
      </div>
    </div>
    {% endif %}

    <!-- Strengths and Improvements Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Key Strengths -->
      {% if summary.analysis.key_strengths %}
      <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-8 border border-emerald-200">
        <div class="flex items-center mb-6">
          <div class="w-12 h-12 bg-emerald-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-star text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Key Strengths</h3>
            <p class="text-gray-600">What your business does exceptionally well</p>
          </div>
        </div>
        <ul class="space-y-3">
          {% for strength in summary.analysis.key_strengths %}
          <li class="flex items-start">
            <i class="fas fa-check-circle text-emerald-600 mr-3 mt-1"></i>
            <span class="text-gray-800 font-medium">{{ strength }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      <!-- Areas for Improvement -->
      {% if summary.analysis.areas_for_improvement %}
      <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-8 border border-amber-200">
        <div class="flex items-center mb-6">
          <div class="w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-exclamation-triangle text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Areas for Improvement</h3>
            <p class="text-gray-600">Priority focus areas for enhancement</p>
          </div>
        </div>
        <ul class="space-y-3">
          {% for improvement in summary.analysis.areas_for_improvement %}
          <li class="flex items-start">
            <i class="fas fa-arrow-up text-amber-600 mr-3 mt-1"></i>
            <span class="text-gray-800 font-medium">{{ improvement }}</span>
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>

    <!-- Advanced Analysis Sections -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- Customer Satisfaction Insights -->
      {% if summary.analysis.customer_satisfaction_insights %}
      <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
        <div class="flex items-center mb-4">
          <div class="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-heart text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Customer Satisfaction</h3>
            <p class="text-gray-600">Patterns and trends analysis</p>
          </div>
        </div>
        <p class="text-gray-800 leading-relaxed">{{ summary.analysis.customer_satisfaction_insights }}</p>
      </div>
      {% endif %}

      <!-- Competitive Positioning -->
      {% if summary.analysis.competitive_positioning %}
      <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
        <div class="flex items-center mb-4">
          <div class="w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-trophy text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Competitive Position</h3>
            <p class="text-gray-600">Market standing analysis</p>
          </div>
        </div>
        <p class="text-gray-800 leading-relaxed">{{ summary.analysis.competitive_positioning }}</p>
      </div>
      {% endif %}

      <!-- Risk Assessment -->
      {% if summary.analysis.risk_assessment %}
      <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
        <div class="flex items-center mb-4">
          <div class="w-12 h-12 bg-red-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-shield-alt text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Risk Assessment</h3>
            <p class="text-gray-600">Potential threats and concerns</p>
          </div>
        </div>
        <p class="text-gray-800 leading-relaxed">{{ summary.analysis.risk_assessment }}</p>
      </div>
      {% endif %}

      <!-- Growth Opportunities -->
      {% if summary.analysis.growth_opportunities %}
      <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
        <div class="flex items-center mb-4">
          <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center mr-4">
            <i class="fas fa-seedling text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900">Growth Opportunities</h3>
            <p class="text-gray-600">Expansion and improvement areas</p>
          </div>
        </div>
        <p class="text-gray-800 leading-relaxed">{{ summary.analysis.growth_opportunities }}</p>
      </div>
      {% endif %}
    </div>

    <!-- Actionable Recommendations -->
    {% if summary.analysis.actionable_recommendations %}
    <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-xl p-8 border border-indigo-200">
      <div class="flex items-center mb-6">
        <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center mr-4">
          <i class="fas fa-lightbulb text-white text-2xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Actionable Recommendations</h3>
          <p class="text-gray-600">Strategic action items for immediate implementation</p>
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {% for recommendation in summary.analysis.actionable_recommendations %}
        <div class="bg-white rounded-lg p-4 border border-indigo-100 hover:shadow-md transition-shadow">
          <div class="flex items-start">
            <span class="bg-indigo-100 text-indigo-800 text-sm font-semibold px-2 py-1 rounded-full mr-3 mt-1">{{ loop.index }}</span>
            <span class="text-gray-800 font-medium">{{ recommendation }}</span>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- Quick Stats -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-8">
      <h3 class="text-xl font-bold text-gray-900 mb-6">Analysis Overview</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="text-center p-4 bg-blue-50 rounded-xl border border-blue-200">
          <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="fas fa-comments text-blue-600 text-lg"></i>
          </div>
          <div class="text-2xl font-bold text-gray-900 mb-1">{{ summary.review_count }}</div>
          <div class="text-gray-600 text-sm">Reviews Analyzed</div>
        </div>
        <div class="text-center p-4 bg-emerald-50 rounded-xl border border-emerald-200">
          <div class="w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="fas fa-star text-emerald-600 text-lg"></i>
          </div>
          <div class="text-2xl font-bold text-gray-900 mb-1">{{ summary.analysis.key_strengths|length }}</div>
          <div class="text-gray-600 text-sm">Key Strengths</div>
        </div>
        <div class="text-center p-4 bg-amber-50 rounded-xl border border-amber-200">
          <div class="w-12 h-12 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="fas fa-arrow-up text-amber-600 text-lg"></i>
          </div>
          <div class="text-2xl font-bold text-gray-900 mb-1">{{ summary.analysis.areas_for_improvement|length }}</div>
          <div class="text-gray-600 text-sm">Improvements</div>
        </div>
        <div class="text-center p-4 bg-purple-50 rounded-xl border border-purple-200">
          <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
            <i class="fas fa-lightbulb text-purple-600 text-lg"></i>
          </div>
          <div class="text-2xl font-bold text-gray-900 mb-1">{{ summary.analysis.actionable_recommendations|length }}</div>
          <div class="text-gray-600 text-sm">Recommendations</div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-8">
      <div class="flex flex-wrap gap-4 justify-center">

        <a href="{{ url_for('view_reviews') }}" 
           class="px-8 py-4 border border-gray-300 rounded-xl font-semibold text-gray-700 hover:bg-gray-100 transition-all">
          <i class="fas fa-list mr-2"></i>View All Reviews
        </a>
        <a href="{{ url_for('ai_reports_history') }}" 
           class="px-8 py-4 border border-purple-300 text-purple-700 rounded-xl font-semibold hover:bg-purple-50 transition-all">
          <i class="fas fa-history mr-2"></i>Reports History
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {   
      window.history.replaceState({}, '', `/ai-reports`);
  });
</script>



{% endblock %}
